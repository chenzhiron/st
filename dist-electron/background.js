"use strict";const{app:o,BrowserWindow:r,ipcMain:s}=require("electron"),n=require("path"),{readYAML:a}=require("./src/utils/regyaml.js"),{PyShell:c}=require("./src/utils/pyshell.js");process.env.ELECTRON_DISABLE_SECURITY_WARNINGS="true";const i=a("./config.yaml"),l=i.Web.url;c("main.py",{mode:"text",pythonPath:n.join(n.cwd(),i.Python.executable),pythonOptions:["-u"]},e=>{console.log("msg",e)},e=>{console.log("err",e)});const t=()=>{const e=new r({icon:join(__dirname,"resource/shortcut.ico"),width:800,height:600,autoHideMenuBar:!0,webPreferences:{contextIsolation:!0,nodeIntegration:!1,preload:join(__dirname,"preload.js")}});process.env.VITE_DEV_SERVER_URL?(e.loadURL(process.env.VITE_DEV_SERVER_URL),e.webContents.openDevTools()):e.loadFile(join(__dirname,"dist/index.html"))};o.whenReady().then(()=>{s.handle("start:web",()=>l),t(),o.on("activate",()=>{r.getAllWindows().length===0&&t()})});o.on("window-all-closed",()=>{process.platform!=="darwin"&&o.quit()});
